services:
  - type: web
    name: clear-urls-bot
    env: docker
    dockerCommand: clear_urls_bot
    plan: starter # Starter plan required for persistent disk
    region: frankfurt
    envVars:
      - key: APP_ENV
        value: production
      - key: RUST_LOG
        value: clear_urls_bot=info,teloxide=info,axum=info
      - key: DATABASE_URL
        # Priority: postgres from environment (if linked), then sqlite disk
        fromDatabase:
          name: clear-urls-db
          property: connectionString
      - key: TELOXIDE_TOKEN
        sync: false
      - key: BOT_USERNAME
        sync: false
      - key: DASHBOARD_URL
        sync: false
      - key: ADMIN_ID
        sync: false
      - key: COOKIE_KEY
        generateValue: true
    disk:
      name: clearurls-data
      mountPath: /etc/clearurls
      sizeGB: 1
    healthCheckPath: /health

databases:
  - name: clear-urls-db
    plan: free
    region: frankfurt
